/* Envelope container */
#envelope {
     position: relative;
     width: 540px;
     height: 360px;
     background-color: #ffc3ce;
     border-bottom-left-radius: 6px;
     border-bottom-right-radius: 6px;
     margin-left: auto;
     margin-right: auto;
     box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
     z-index: 1;
     perspective: 1200px;
}

/* Flaps */
.front {
     position: absolute;
     width: 100%;
     height: 100%;
     transition: transform 0.6s ease;
     pointer-events: none;
}

/* Top flap */
.front.top {
     border-top: 180px solid #ffc3ce;
     border-left: 180px solid transparent;
     border-right: 180px solid transparent;
     border-bottom: 180px solid transparent;
     transform-origin: top center;
     z-index: 7;
}

/* Left flap */
.front.left {
     border-top: 180px solid transparent;
     border-left: 180px solid #ffcdd8;
     border-right: 180px solid transparent;
     border-bottom: 180px solid #ffc3ce;
     transform-origin: left center;
     z-index: 10;
     box-shadow: -4px 4px 12px rgba(0, 0, 0, 0.15);
}

/* Right flap */
.front.right {
     border-top: 180px solid transparent;
     border-left: 180px solid transparent;
     border-right: 180px solid #ffb9c4;
     border-bottom: 180px solid transparent;
     transform-origin: right center;
     z-index: 9;
     box-shadow: 4px 4px 12px rgba(0, 0, 0, 0.15);
}

/* Bottom flap */
.front.bottom {
     border-top: 0px solid transparent;
     border-left: 270px solid transparent;
     border-right: 270px solid transparent;
     border-bottom: 270px solid #ffd7e2;
     transform-origin: bottom center;
     z-index: 10;
     box-shadow: 0 6px 14px rgba(0, 0, 0, 0.2);
}

/* Letter */
.letter {
     position: absolute;
     top: 18px;
     left: 18px;
     right: 18px;
     bottom: 18px;
     background: white;
     border-radius: 4px;
     box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
     z-index: 2;
     text-align: center;
     padding: 18px;
     transition: transform 0.6s ease;
}

/* ============================= */
/* OPEN STATE TIMINGS */
/* ============================= */
.letter {
     z-index: 2;
     transition: transform 0.4s ease;
}

/* Top flap opens first */
#envelope.open .front.top {
     transform: rotateX(-180deg);
     transition-delay: 0s;
}

/* Closing: letter slides in first */
#envelope.close .letter {
     transform: translateY(0);
     transition-delay: 0s;
     animation: dropZ 0.01s step-end 0.4s forwards;
}

/* Opening: reset immediately */
#envelope.open .letter {
     transform: translateY(-60px);
     transition-delay: 0.4s;
     animation: raiseZ 0.01s step-end 0.4s forwards;
}

#envelope.close .front.top {
     transform: rotateX(0deg);
     transition-delay: 0.35s;
}


.heart {
     position: absolute;
     left: 50%;
     top: 50%;
     width: 30px;
     height: 30px;
     background: #ff5c8a;
     transform: translate(-50%, -50%) rotate(45deg);
     opacity: 0;
     pointer-events: none;
     z-index: 20;
     /* ABOVE all flaps */
}

/* Heart shape */
.heart::before,
.heart::after {
     content: "";
     position: absolute;
     width: 30px;
     height: 30px;
     background: #ff5c8a;
     border-radius: 50%;
}

.heart::before {
     top: -15px;
     left: 0;
}

.heart::after {
     left: -15px;
     top: 0;
}